## [LMFACT](https://help.hexagonmi.com/bundle/MSC_Nastran_2022.4/page/Nastran_Combined_Book/qrg/parameters/TOC.LMFACT.xhtml)

LMFACT and PENFN are the scale factor and penalty function for the Lagrange rigid elements and the contact analysis. For Lagrange rigid elements, please see Case Control command, RIGID. The purpose of LMFACT and PENFN is to make the values of stiffness matrix of the Lagrange rigid elements and/or the contact components about the same relative magnitude as those of the other elements in the model. Too small a value will produce inaccurate results and too large a value will produce numerical difficulties. The same value is usually assigned to both LMFACT and PENFN. Under special requirement, user may assign different values for LMFACT and PENFN. For example, if PENFN=0.0 and  ![parameters01743.jpg](https://help-be.hexagonmi.com/bundle/MSC_Nastran_2022.4/page/Nastran_Combined_Book/qrg/parameters/../../../assets/parameters01743.jpg?_LANG=enus) , then the solution method for the rigid elements becomes the pure Lagrange multiplier method instead of the augmented Lagrangian method. However, user must exercise caution if different values are assigned to LMFACT and PENFN. MSC Nastran will compute the appropriate default values for LMFACT and PENFN. The default value is 1.0e+5 for all solution sequences except SOL 400 and SOL 101 contact.

For SOL 400 and SOL 101 contact, MSC Nastran will compute the appropriate default values for LMFACT and PENFN. These defaults are currently calculated as 0.05% of the average stiffness of the diagonal terms of the stiffness matrix. This computed default is good in general. But when the material/element stiffnesses (e.g., Youngâ€™s Modulus, Spring Stiffnesses) used in the model vary in a wide range, users may have to adjust the computed LMFACT and PENFN. Note that the computed LMFACT, PENFN are printed out in a .f06 file. It is generally recommended that for these cases, the LMFACT and PENFN should be reduced by several orders of magnitude to avoid numerical difficulty.

If in a coupled multi-physics analysis distinct values for LMFACT and PENFN are desired for each physics pass, the parameter definitions must be made inside the SUBSTEP Case Control command. If no values are entered each physics pass computes its own defaults.

